<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Servidor de Anotações, Gastos & Wiki - Luiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="styles.css" />

  <!-- Supabase JS v2 -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <!-- Chart.js para gráficos de gastos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="top-header">
    <div class="logo-area">
      <!-- ajuste o src se o nome do arquivo da logo for outro -->
      <div class="logo-circle">LF</div>
      <div>
        <h1>Servidor de Anotações &amp; Gastos</h1>
        <p>Central do Luiz para estudos, pesquisas e controle financeiro</p>
      </div>
    </div>
  </header>

  <main class="page-container">
    <!-- Tabs -->
    <nav class="main-tabs">
      <button class="tab-btn active" data-tab="notes">
        Anotações
        <span class="tab-subtitle">Estudos, pesquisas, protocolos, comandos…</span>
      </button>
      <button class="tab-btn" data-tab="expenses">
        Gastos
        <span class="tab-subtitle">Contas do mês, categorias e gráficos</span>
      </button>
      <button class="tab-btn" data-tab="wiki">
        Wiki de comandos
        <span class="tab-subtitle">OLT, switches, roteadores e mais</span>
      </button>
    </nav>

    <!-- ===================== TAB: ANOTAÇÕES ===================== -->
    <section id="tab-notes" class="tab-content active">
      <div class="grid-2">
        <!-- Formulário de anotação -->
        <section class="panel">
          <h2>Nova anotação / Editar</h2>
          <form id="noteForm" class="form">
            <input type="hidden" id="noteId" />

            <div class="form-group">
              <label for="titleInput">Título</label>
              <input
                type="text"
                id="titleInput"
                placeholder="Ex: Neuropatia periférica por quimioterapia"
                required
              />
            </div>

            <div class="form-group">
              <label for="categoryInput">Categoria</label>
              <input
                type="text"
                id="categoryInput"
                placeholder="Ex: T.I & Redes, Projetos, Automação, Vida pessoal…"
                list="categorySuggestions"
                required
              />
              <datalist id="categorySuggestions">
                <option value="T.I & Redes"></option>
                <option value="Projetos"></option>
                <option value="Vida pessoal / Desenvolvimento / Suplementos"></option>
                <option value="Automação (Python, N8N, APIs, Power BI)"></option>
              </datalist>
            </div>

            <div class="form-group">
              <label for="tagsInput">Tags (separadas por vírgula)</label>
              <input
                type="text"
                id="tagsInput"
                placeholder="Ex: oncologia, neuropatia, artigo, estudo"
              />
            </div>

            <div class="form-group">
              <label for="contentInput">Conteúdo</label>
              <textarea
                id="contentInput"
                rows="8"
                placeholder="Digite aqui o resumo, pontos importantes, protocolos, comandos, etc."
                required
              ></textarea>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Salvar anotação</button>
              <button type="button" id="clearFormBtn" class="btn btn-secondary">
                Limpar formulário
              </button>
            </div>
          </form>
        </section>

        <!-- Lista de anotações -->
        <section class="panel">
          <div class="panel-header">
            <h2>Anotações</h2>
          </div>

          <div class="filters-row">
            <div class="form-group">
              <label for="searchInput">Buscar</label>
              <input
                type="text"
                id="searchInput"
                placeholder="Busque por título, conteúdo ou tag…"
              />
            </div>

            <div class="form-group">
              <label for="categoryFilter">Filtrar por categoria</label>
              <select id="categoryFilter">
                <option value="">Todas</option>
              </select>
            </div>

            <div class="form-group">
              <label for="sortSelect">Ordenar por</label>
              <select id="sortSelect">
                <option value="newest">Mais recentes</option>
                <option value="oldest">Mais antigas</option>
                <option value="title">Título (A-Z)</option>
              </select>
            </div>
          </div>

          <div id="notesList" class="notes-list"></div>
        </section>
      </div>

      <footer class="section-footer">
        <small>Anotações salvas no Supabase.</small>
      </footer>
    </section>

    <!-- ===================== TAB: GASTOS ===================== -->
    <section id="tab-expenses" class="tab-content">
      <div class="grid-2">
        <!-- Formulário de gastos -->
        <section class="panel">
          <h2>Gastos do mês</h2>
          <form id="expenseForm" class="form">
            <div class="form-group">
              <label for="expenseDesc">Descrição</label>
              <input
                type="text"
                id="expenseDesc"
                placeholder="Ex: Conta de luz, Mercado, Netflix"
                required
              />
            </div>

            <div class="form-group">
              <label for="expenseCategory">Categoria</label>
              <input
                type="text"
                id="expenseCategory"
                placeholder="Ex: Moradia, Alimentação, Lazer…"
                list="expenseCategorySuggestions"
                required
              />
              <datalist id="expenseCategorySuggestions">
                <option value="Moradia"></option>
                <option value="Alimentação"></option>
                <option value="Lazer"></option>
                <option value="Saúde"></option>
                <option value="Transporte"></option>
                <option value="Educação"></option>
              </datalist>
            </div>

            <div class="form-group">
              <label for="expenseValue">Valor (R$)</label>
              <input
                type="number"
                step="0.01"
                min="0"
                id="expenseValue"
                placeholder="Ex: 250.90"
                required
              />
            </div>

            <div class="form-group">
              <label for="expenseDate">Data</label>
              <input type="date" id="expenseDate" required />
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Adicionar gasto</button>
            </div>
          </form>
        </section>

        <!-- Resumo + gráfico -->
        <section class="panel">
          <h2>Resumo e gráfico</h2>
          <p class="summary-text">
            Total do período: <strong id="expensesTotal">R$ 0,00</strong>
          </p>

          <div class="filters-row">
            <div class="form-group">
              <label for="expenseCategoryFilter">Filtrar por categoria</label>
              <select id="expenseCategoryFilter">
                <option value="">Todas</option>
              </select>
            </div>
          </div>

          <div class="chart-wrapper">
            <canvas id="expensesChart" height="140"></canvas>
          </div>
        </section>
      </div>

      <!-- Lista de gastos -->
      <section class="panel panel-full">
        <div class="panel-header">
          <h2>Lista de gastos</h2>
        </div>
        <div class="table-wrapper">
          <table class="table">
            <thead>
              <tr>
                <th>Data</th>
                <th>Descrição</th>
                <th>Categoria</th>
                <th>Valor (R$)</th>
              </tr>
            </thead>
            <tbody id="expensesTableBody"></tbody>
          </table>
        </div>
      </section>

      <footer class="section-footer">
        <small>Gastos salvos no navegador (localStorage).</small>
      </footer>
    </section>

    <!-- ===================== TAB: WIKI ===================== -->
    <section id="tab-wiki" class="tab-content">
      <div class="grid-2">
        <!-- Formulário Wiki -->
        <section class="panel">
          <h2>Nova entrada na Wiki / Editar</h2>
          <form id="wikiForm" class="form">
            <input type="hidden" id="wikiId" />

            <div class="form-group">
              <label for="wikiTitle">Título</label>
              <input
                type="text"
                id="wikiTitle"
                placeholder="Ex: Listar ONUs pendentes ZTE C320"
                required
              />
            </div>

            <div class="form-group">
              <label for="wikiVendor">Fabricante</label>
              <input
                type="text"
                id="wikiVendor"
                placeholder="Ex: ZTE, Datacom, Huawei…"
                required
              />
            </div>

            <div class="form-group">
              <label for="wikiDeviceType">Equipamento</label>
              <input
                type="text"
                id="wikiDeviceType"
                placeholder="Ex: OLT, Switch, Router…"
                required
              />
            </div>

            <div class="form-group">
              <label for="wikiModel">Modelo</label>
              <input
                type="text"
                id="wikiModel"
                placeholder="Ex: C320, C600, DM4610…"
              />
            </div>

            <div class="form-group">
              <label for="wikiContext">Contexto / sessão</label>
              <input
                type="text"
                id="wikiContext"
                placeholder="Ex: GPON, VLAN, PPPoE, Interface…"
              />
            </div>

            <div class="form-group">
              <label for="wikiCommand">Comando</label>
              <textarea
                id="wikiCommand"
                rows="4"
                placeholder="Cole aqui o comando, com quebras de linha se precisar."
                required
              ></textarea>
            </div>

            <div class="form-group">
              <label for="wikiDescription">Descrição / Observações</label>
              <textarea
                id="wikiDescription"
                rows="4"
                placeholder="Explique o que o comando faz, quando usar, cuidados, etc."
              ></textarea>
            </div>

            <div class="form-group">
              <label for="wikiTags">Tags (separadas por vírgula)</label>
              <input
                type="text"
                id="wikiTags"
                placeholder="Ex: onu, vlan, show, authorize"
              />
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Salvar comando</button>
              <button type="button" id="wikiClearBtn" class="btn btn-secondary">
                Limpar formulário
              </button>
            </div>
          </form>
        </section>

        <!-- Lista Wiki -->
        <section class="panel">
          <div class="panel-header">
            <h2>Wiki de comandos</h2>
          </div>

          <div class="filters-row">
            <div class="form-group">
              <label for="wikiSearch">Buscar</label>
              <input
                type="text"
                id="wikiSearch"
                placeholder="Busque por título, comando, descrição ou tag…"
              />
            </div>

            <div class="form-group">
              <label for="wikiVendorFilter">Fabricante</label>
              <select id="wikiVendorFilter">
                <option value="">Todos</option>
              </select>
            </div>

            <div class="form-group">
              <label for="wikiDeviceTypeFilter">Equipamento</label>
              <select id="wikiDeviceTypeFilter">
                <option value="">Todos</option>
              </select>
            </div>

            <div class="form-group">
              <label for="wikiContextFilter">Contexto</label>
              <select id="wikiContextFilter">
                <option value="">Todos</option>
              </select>
            </div>
          </div>

          <div id="wikiList" class="wiki-list"></div>
        </section>
      </div>

      <footer class="section-footer">
        <small>Wiki de comandos salva no Supabase.</small>
      </footer>
    </section>
  </main>

  <script>
    // =========================
    // Supabase Client
    // =========================
    const supabaseUrl = "https://arfxhdwvrsfnkgyltbbh.supabase.co";
    const supabaseAnonKey =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyZnhoZHd2cnNmbmtneWx0YmJoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwNTM4OTYsImV4cCI6MjA4MDYyOTg5Nn0.jlutOwYLPmJ7y0uwrwyVpuNUJHusRFi5r18-_-xfAxg";

    window.supabaseClient = window.supabase.createClient(
      supabaseUrl,
      supabaseAnonKey
    );
  </script>

  <script src="app.js"></script>
</body>
</html>